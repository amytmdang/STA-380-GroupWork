---
title: "HW1 Segmentation"
author: "Abraham Khan"
date: "August 8, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Market Segmentation

```{r libraries, echo=FALSE, message=FALSE, warning=FALSE}
library(kableExtra)
library(ggplot2)
library(LICORS) 
library(foreach)
library(mosaic)
```



```{r Read Data, echo=FALSE, message=FALSE, warning=FALSE}
set.seed(343)
sm = read.csv('C:/Users/Abraham/Desktop/UT/MSBA/Intro Predictive Modeling/social_marketing.csv', header=TRUE)
#Drop randomized ID column
sm <- sm[-c(1)]

# Scale the data
sm <- na.omit(sm)
sm_scaled = scale(sm, center=TRUE, scale=TRUE)
```

#Find K

```{r Find K, echo=FALSE}
#kmeans 
#Try different K clusters
CHIndex=sapply(2:30,function(k){
  model = kmeans(sm_scaled,k, iter.max=15)
  (model$betweenss/(k-1))/(model$totss/(36-k))  
  })
plot(2:30,CHIndex, type='b', pch=20, xlab='Number of Clusters')

# Use k-means + + to get 6 clusters
cluster_all <- kmeanspp(sm_scaled, k=6)
```

The above graph shows the result of running a Kmeans model on the entire scaled dataset and calculating the CH Index value for each value of k (number of clusters). We chose a k = 6 from the plot where the points formed a small elbow, and then ran the KMeans cluster analysis. After running the cluster analysis, we plotted pairwise plots of the top five variables (sorted by importance to cluster) in each cluster (representing our six market segments), which gave the following graphs and interpretations per group. 

<br>

###Cluster 1 - The Noise/Bots

*11.27% of followers*

This cluster is composed mainly of those tags Twitter tries to weed out, including spam, random chatter, and inappropriate adult content. It can be mostly randomly generated by bots, so it's very irrelevant for Nutrient H2O's marketing team to focus on these characteristics.

```{r Cluster1, echo=FALSE}
# Plot with labels
check1 = sm_scaled[,names(sort(cluster_all$centers[1,])[32:36])]
pairs(check1, pch=20, col=rainbow(6)[cluster_all$cluster])
```


###Cluster 2 - The Instagram Influencer

*5.44% of followers*

Those in this segment are most likely social-media savvy and are on top of trends relating to music, photo sharing, beauty, fashion, and cooking. They share a lot of photos relating to their lifestyle and these categories suggest that the content they share could be curated according to these categories. Nutrient H2O can appeal to this segment by sharing/retweeting photos and possibly relate their products to current trends relating to fashion, beauty, cooking, etc.  

```{r Cluster2, echo=FALSE}
# Plot with labels
check2 = sm_scaled[,names(sort(cluster_all$centers[2,])[32:36])]
pairs(check2, pch=20, col=rainbow(6)[cluster_all$cluster])

```

###Cluster 3 - The Young Professional

*7.28% of followers*

This cluster was identified by valuing subjects such as automotives, computers, travel, the news, and politics very highly. A young professional would travel a lot for work, be highly technology savvy, and very engaged in news and politics. They love sports cars, and they hate Trump. We'd suggest for Nutrient H2O to focus on appealing to their politically active tendencies and being up-to-date on news.


```{r Cluster3, echo=FALSE}
# Plot with labels
check3 = sm_scaled[,names(sort(cluster_all$centers[3,])[32:36])]
pairs(check3, pch=20, col=rainbow(6)[cluster_all$cluster])

```

###Cluster 4 - The Whole Foodies

*8.65% of followers*

This cluster of healthy eating fans are really into bettering their lifestyles in various ways. They're the kind of people that meal prep using kale, spend time outdoors doing goat yoga, and indulge in SoulCycle at least once a week. Most likely, they own a metal straw #savetheturtles. Nutrient H2O can appeal to this segment by highlighting the health benefits in their products and supporting eco-friendly, sustainable practices.

```{r Cluster4, echo=FALSE}
# Plot with labels
check4 = sm_scaled[,names(sort(cluster_all$centers[4,])[32:36])]
pairs(check4, pch=20, col=rainbow(6)[cluster_all$cluster])

```

###Cluster 5 - The College Student

*9.96% of followers*

Your average college student is highly engaged in the bubble of their school activities and social life. Often, they escape from the pressure of deadlines by immersing themselves into activities like Netflix, gaming online, and ultimate frisbee or flag football. Nutrient H2O can win this segment over with NFL-themed deals, or by appealing to school pride. 

```{r Cluster5, echo=FALSE}
# Plot with labels
check5 = sm_scaled[,names(sort(cluster_all$centers[5,])[32:36])]
pairs(check5, pch=20, col=rainbow(6)[cluster_all$cluster])

```

###Cluster 6 - The Soccer Moms

*57.66% of followers*

This cluster represents the the typical soccer mom, tweeting about things relating to school, food, sports, parenting, and religion. They're probably the super involved parents, volunteering at their kids' schools, signing their kids up for various sports and afterschool activities, and goes to church every Sunday. They're not regular moms, they're "cool moms." Nutrient H2O can capture this segment by relating their marketing and advertising to subjects like school, sports, or anything relating to their kids. This is the largest segment by far and holds a lot of spending power, so Nutrient H2O should definitely focus significant energy and marketing dollars on this group.    

```{r Cluster6, echo=FALSE}
# Plot with labels 
check6 = sm_scaled[,names(sort(cluster_all$centers[6,])[32:36])]
pairs(check6, pch=20, col=rainbow(6)[cluster_all$cluster])

```

```{r Cluster Counts, echo=FALSE}
counts = matrix(0,nrow=1,ncol=6)

for(c in 1:6){
  counts[1,c] = length(cluster_all$cluster[cluster_all$cluster==c])/7882*100
}

#counts
```


